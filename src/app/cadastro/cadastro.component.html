<div class="container-fluid">
  <app-menu-principal></app-menu-principal>

  <div>
    <form (ngSubmit)="cadastrar()" [formGroup]="formValidation">

      <label for="nomeCompleto">Nome Completo</label>
      <input type="text" name="nomeCompleto"  formControlName="nomeCompleto" id="nomeCompleto" maxlength="45" required>

      <div *ngIf="(formValidation.get('nomeCompleto')?.invalid && formSubmitted) && !formReset" class="validation-error">
        <p *ngIf="formValidation.get('nomeCompleto')?.errors?.['required']" class="message-error-formValidation">
          Informe o nome completo
        </p>
      </div>


      <label for="cpf">CPF</label>
      <input type="text" name="cpf" mask="000.000.000-00" formControlName="cpf" id="cpf" required>
      <div *ngIf="(formValidation.get('cpf')?.invalid && formSubmitted) && !formReset" class="validation-error">
        <ng-container *ngIf="formValidation.get('cpf')?.errors?.['required']; else cpfIncorreto">
          <p class="message-error-formValidation">Informe o CPF</p>
        </ng-container>
        <ng-template #cpfIncorreto>
          <p class="message-error-formValidation">CPF incorreto</p>
        </ng-template>
      </div>


      <label for="email">E-mail</label>
      <input type="text" name="email" formControlName="email" id="email" required>
      <div *ngIf="(formValidation.get('email')?.invalid && formSubmitted) && !formReset" class="validation-error">
        <ng-container *ngIf="formValidation.get('email')?.errors?.['required']; else emailIncorreto" >
          <p class="message-error-formValidation">Informe um e-mail</p>
        </ng-container>
        <ng-template #emailIncorreto>
          <p class="message-error-formValidation">Declaração de e-mail incorreto  </p>
        </ng-template>
      </div>

      <label for="telefone">Telefone</label>
      <input type="tel" name="telefone" mask="(00) 0 0000-0000" formControlName="telefone" id="telefone" required>
      <div *ngIf="(formValidation.get('telefone')?.invalid && formSubmitted) && !formReset" class="validation-error">
        <ng-container *ngIf="formValidation.get('telefone')?.errors?.['required']; else telefoneIncorreto">
          <p class="message-error-formValidation">Informe um telefone</p>
        </ng-container>
        <ng-template #telefoneIncorreto>
          <p class="message-error-formValidation">Telefone incorreto</p>
        </ng-template>
      </div>


      <label for="telefone-para-contato">Telefone para contato</label>
      <input type="text" name="telefone-para-contato" mask="(00) 0 0000-0000" formControlName="telefoneContato" id="telefone-para-contato">
      <div *ngIf="(formValidation.get('telefoneContato')?.invalid && formSubmitted) && !formReset" class="validation-error">
        <p class="message-error-formValidation">Telefone incorreto</p>
      </div>

      <!-- <label for="data-de-nascimento">Data de nascimento</label>
      <input type="date" name="data-de-nascimento" formControlName="dataNascimento" id="data-de-nascimento"
      (blur)="onBlurDataNascimento()" required > -->

      <p-calendar
        formControlName="dataNascimento"
        id="data-de-nascimento"
        (onSelect)="onBlurDataNascimento()"
        (onInput)="onInputDataNascimento()"
        [required]="true"
        mask="'99/99/9999'"
        dataType="string"
        dateFormat="dd/mm/yy"
        placeholder="Selecione a data"
        class="custom-calendar">
      </p-calendar>

      <div *ngIf="(formValidation.get('dataNascimento')?.invalid && formSubmitted) && !formReset" class="validation-error">
        <ng-container *ngIf="formValidation.get('dataNascimento')?.errors?.['required']; else dataNascimentoIncorreta">
          <p class="message-error-formValidation">Informe a data de nascimento</p>
        </ng-container>
        <ng-template #dataNascimentoIncorreta>
          <p class="message-error-formValidation">Data de nascimento incorreta</p>
        </ng-template>
      </div>


      <br>

      <label for="idade">Idade</label>
      <input type="number" name="idade"  formControlName="idade" id="idade" required (focus)="onFocusIdade()">

      <label for="estado-civil">Estado Civil</label>

      <select name="estado-civil" id="estado-civil" formControlName="estadoCivil" required>
        <option value="solteiro">Solteiro(a)</option>
        <option value="casado">Casado(a)</option>
        <option value="divorcioado">Divorciado(a)</option>
        <option value="viuvo">Viuvo(a)</option>
        <option value="outro">Outro</option>
      </select>

      <div *ngIf="(formValidation.get('estadoCivil')?.invalid && formSubmitted) && !formReset" class="validation-error">
        <p class="message-error-formValidation">Informe o estado civil</p>
      </div>




      <label for="filhos">Filhos</label>
      <select name="filhos" formControlName="filhos" id="filhos" required>
        <option value="sim">Sim</option>
        <option value="nao">Não</option>
      </select>

      <label for="qtdFilhos">Qtd. de filhos</label>
      <input type="number" name="qtdFilhos" formControlName="qtdFilhos" id="qtdFilhos" required min="1">

      <div *ngIf="(formValidation.get('qtdFilhos')?.invalid && formSubmitted) && !formReset && formQtdFilhos" class="validation-error">
        <p class="message-error-formValidation">Informe a quantidade</p>
      </div>


      <label for="grau-escolaridade">Grau de escolaridade</label>
      <select type="text" name="grau-escolaridade" formControlName="grauEscolaridade" id="grau-escolaridade" required>
        <option value=""></option>
        <option value="Doutorado">Doutorado</option>
        <option value="Ensino Fundamental Completo">Ensino Fundamental Completo</option>
        <option value="Ensino Fundamental Incompleto">Ensino Fundamental Incompleto</option>
        <option value="Ensino Médio Completo">Ensino Médio Completo</option>
        <option value="Ensino Médio Incompleto">Ensino Médio Incompleto</option>
        <option value="Ensino Superior Completo">Ensino Superior Completo</option>
        <option value="Ensino Superior Incompleto">Ensino Superior Incompleto</option>
        <option value="Mestrado">Mestrado</option>
        <option value="Pós-graduação">Pós-graduação</option>
      </select>

      <div *ngIf="(formValidation.get('grauEscolaridade')?.invalid && formSubmitted) && !formReset" class="validation-error">
        <p class="message-error-formValidation">Informe o grau de escolaridade</p>
      </div>


      <label for="profissao">Profissão</label>
      <input type="text" name="profissao" formControlName="profissao" id="profissao" maxlength="50" required>

      <div *ngIf="(formValidation.get('profissao')?.invalid && formSubmitted) && !formReset" class="validation-error">
        <ng-container *ngIf="formValidation.get('profissao')?.errors?.['required']; else profissaoIncorreta">
          <p class="message-error-formValidation">Informe a profissão</p>
        </ng-container>
        <ng-template #profissaoIncorreta>
          <p class="message-error-formValidation">Valor minimo 3 caracteres</p>
        </ng-template>
      </div>



      <label for="perfil">Perfil</label>
      <select name="perfil" formControlName="perfil" id="perfil">  <!-- dados renderizados da api -->
        <option value=""></option>
        <option *ngFor="let perfil of getPerfilEnumKeys()" [value]="perfil">
          {{ perfil }}
        </option>
        <!-- <option value="psicologia">Psicologia</option>
        <option value="psicoterapia">Psicoterapia</option>
        <option value="orcamento">Orçamento</option> -->
      </select>

      <div *ngIf="(formValidation.get('perfil')?.invalid && formSubmitted) && !formReset" class="validation-error">
        <p class="message-error-formValidation">Informe o perfil do paciente</p>
      </div>
      <div *ngIf="(formValidation.get('perfil')?.invalid && formSubmitted) && !formReset" class="validation-error">
        <p class="message-error-formValidation">Informe o perfil do paciente</p>
      </div>




      <label for="cep">CEP</label>
      <input type="text" name="cep" formControlName="cep" id="cep" mask="00000-000" maxlength="9" required>

      <div *ngIf="(formValidation.get('cep')?.invalid && formSubmitted) && !formReset" class="validation-error">
        <ng-container *ngIf="formValidation.get('cep')?.errors?.['required']; else profissaoIncorreta">
          <p class="message-error-formValidation">Informe o CEP</p>
        </ng-container>
        <ng-template #profissaoIncorreta>
          <p class="message-error-formValidation">CEP inválido</p>
        </ng-template>
      </div>


      <label for="logradouro">Rua</label>
      <input type="text" name="logradouro" formControlName="logradouro" id="logradouro" required>
      <div *ngIf="(formValidation.get('logradouro')?.invalid && formSubmitted) && !formReset" class="validation-error">
        <p class="message-error-formValidation">Informe a rua</p>
      </div>


      <label for="numero">Número</label>
      <input type="number" name="numero" formControlName="numero" id="numero" min="1" maxlength="60" required>   <!-- tratar como number | aceitar apenas numeros  -->
      <div *ngIf="(formValidation.get('numero')?.invalid && formSubmitted) && !formReset" class="validation-error">
        <ng-container *ngIf="formValidation.get('numero')?.errors?.['required']; else profissaoIncorreta">
          <p class="message-error-formValidation">Informe o número do local</p>
        </ng-container>
        <ng-template #profissaoIncorreta>
          <p class="message-error-formValidation">Número inválido</p>
        </ng-template>
      </div>

      <label for="complemento">Complemento</label>
      <input type="text" name="complemento" formControlName="complemento" id="complemento" maxlength="45" required>

      <label for="bairro">Bairro</label>
      <input type="text" name="bairro" formControlName="bairro" id="bairro" maxlength="40" required>
      <div *ngIf="(formValidation.get('bairro')?.invalid && formSubmitted) && !formReset" class="validation-error">
        <p class="message-error-formValidation">Informe o bairro</p>
      </div>

      <label for="cidade">Cidade</label>
      <input type="text" name="cidade" formControlName="cidade" id="cidade" required>
      <div *ngIf="(formValidation.get('cidade')?.invalid && formSubmitted) && !formReset" class="validation-error">
        <p class="message-error-formValidation">Informe a cidade</p>
      </div>


      <label for="uf">UF</label>
      <select  name="uf" formControlName="uf" id="estado" required>
        <option *ngFor="let uf of  optionUf" [value]="uf.sigla">{{ uf.nome }}</option>
      </select>
      <div *ngIf="(formValidation.get('uf')?.invalid && formSubmitted) && !formReset" class="validation-error">
        <p class="message-error-formValidation">Informe um estado</p>
      </div>



      <label for="queixa">Queixa do paciente</label>
      <textarea name="queixa" formControlName="queixa" id="queixa" required></textarea>
      <div *ngIf="(formValidation.get('queixa')?.invalid && formSubmitted) && !formReset" class="validation-error">
        <p class="message-error-formValidation">Descreva a queixa do paciente</p>
      </div>

    <br>

    <button type="submit">Registrar</button>

    <div *ngIf="ativarLoading" style="margin-left: 1rem;">
      <img src="../../assets/img/loading-tela-cadastro-paciente.gif" alt="Aguarde..." class="img-loading no-select-img" />
    </div>

    </form>
  </div>





</div>
